<!DOCTYPE html>
<html lang="pt-BR">
<head>…</head>
<body>
  <!-- ... cabeçalho e inputs ... -->
  <input type="date" id="dateSearch" />
  <button id="btnSearch">Buscar</button>
  <!-- ... tabela e mensagens ... -->

  <script>
    function removerAcentos(str) { /* ... */ }

    document.addEventListener('DOMContentLoaded', () => {
      const inputDate = document.getElementById('dateSearch');
      const btn       = document.getElementById('btnSearch');
      const table     = document.getElementById('resultsTable');
      const tbody     = table.querySelector('tbody');
      const noResults = document.getElementById('noResults');
      const error     = document.getElementById('error');

      btn.addEventListener('click', () => {
        const dataBusc = inputDate.value; // "YYYY-MM-DD"
        if (!dataBusc) return;

        // monta nome do arquivo no padrão que você já gera no Colab:
        // ensalamento_detalhado_YYYYMMDD.json
        const [ano, mes, dia] = dataBusc.split('-');
        const filename = `ensalamento_detalhado_${ano}${mes}${dia}.json`;
        const urlJson  = `${filename}?ts=${Date.now()}`;

        fetch(urlJson, { cache: 'no-store' })
          .then(r => {
            if (!r.ok) throw new Error(`HTTP ${r.status}`);
            return r.json();
          })
          .then(dados => {
            tbody.innerHTML = '';
            const lista = Array.isArray(dados) ? dados : [dados];
            if (lista.length === 0) {
              table.hidden = true;
              noResults.hidden = false;
            } else {
              noResults.hidden = true;
              table.hidden = false;
              lista.forEach(item => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                  <td>${item.nome}</td>
                  <td>${item.sala}</td>
                  <td>${item.carteira}</td>
                `;
                tbody.appendChild(tr);
              });
            }
          })
          .catch(err => {
            console.error(err);
            error.hidden = false;
          });
      });
    });
  </script>
</body>
</html>
